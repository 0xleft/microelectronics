#include "LedControl.h"

struct LedLetter {
  char letter;
  uint8_t array[8];
};

LedControl lc = LedControl(12,10,11,4);

void setupLeds(int displayCount) {
  for (int i = 0; i < displayCount; i++) {
    lc.shutdown(i, false);
    lc.setIntensity(i,15);
    lc.clearDisplay(i);
  }
}

LedLetter LED_LETTERS[] {
  {'a', {B00000000,B00000010,B00000010,B00011100,B00010010,B00010010,B00001100,B00000000}},
  {'b', {B00000000,B00000000,B00000100,B00001010,B00001010,B01111110,B00000000,B00000000}},
  {'c', {B00000000,B00000000,B00100010,B00100010,B00100010,B00011100,B00000000,B00000000}},
  {'d', {B00000000,B00000000,B00000000,B01111110,B00001010,B00001010,B00000100,B00000000}},
  {'e', {B00000000,B00000000,B00011010,B00101010,B00101010,B00011100,B00000000,B00000000}},
  {'f', {B00000000,B00000000,B01000000,B01000000,B01001000,B00111110,B00001000,B00000000}},
  {'g', {B00000000,B00000000,B00101000,B01001110,B01001010,B01000010,B00111100,B00000000}},
  {'h', {B00000000,B00000000,B00000110,B00001000,B00001000,B01111110,B00000000,B00000000}},
  {'i', {B00000000,B00000000,B00000000,B00000010,B01011110,B00000000,B00000000,B00000000}},
  {'j', {B00000000,B00000000,B00000000,B01011100,B00000010,B00000010,B00000100,B00000000}},
  {'k', {B00000000,B00000000,B00100010,B00010100,B00001000,B01111110,B00000000,B00000000}},
  {'l', {B00000000,B00000000,B00000000,B00000010,B00000010,B01111100,B00000000,B00000000}},
  {'m', {B00000000,B00000000,B00001100,B00010000,B00001100,B00010000,B00111100,B00000000}},
  {'n', {B00000000,B00000000,B00000000,B00001100,B00010000,B00111100,B00000000,B00000000}},
  {'o', {B00000000,B00000000,B00001100,B00010010,B00010010,B00001100,B00000000,B00000000}},
  {'p', {B00000000,B00000000,B00010000,B00101000,B00101000,B00111110,B00000000,B00000000}},
  {'q', {B00000000,B00000100,B00111110,B01001000,B01001000,B00110000,B00000000,B00000000}},
  {'r', {B00000000,B00000000,B00100000,B00100000,B00010000,B00111110,B00000000,B00000000}},
  {'s', {B00000000,B00000000,B00000100,B00101010,B00101010,B00010000,B00000000,B00000000}},
  {'t', {B00000000,B00000000,B00000000,B00010010,B00010010,B01111100,B00000000,B00000000}},
  {'u', {B00000000,B00000000,B00011100,B00000010,B00000010,B00011100,B00000000,B00000000}},
  {'v', {B00000000,B00000000,B00011100,B00000010,B00000100,B00011000,B00000000,B00000000}},
  {'w', {B00000000,B00000000,B00011100,B00000010,B00000100,B00000010,B00011100,B00000000}},
  {'x', {B00000000,B00000000,B00100010,B00010100,B00001000,B00010100,B00100010,B00000000}},
  {'y', {B00000000,B00000000,B01000000,B00100000,B00011110,B00100000,B01000000,B00000000}},
  {'z', {B00000000,B00000000,B00100010,B00110010,B00101010,B00100110,B00100010,B00000000}},
  {'0', {B00000000,B00000000,B00011100,B00100010,B00100010,B00011100,B00000000,B00000000}},
  {'1', {B00000000,B00000000,B00000000,B00000010,B01111110,B00100010,B00010000,B00000000}},
  {'2', {B00000000,B00000000,B00100010,B01010010,B01001010,B01000110,B00100010,B00000000}},
  {'3', {B00000000,B00000000,B00010100,B00101010,B00101010,B00101010,B00100010,B00000000}},
  {'4', {B00000000,B00000000,B00000100,B01001110,B00100100,B00010100,B00001100,B00000000}},
  {'5', {B00000000,B00000000,B00100110,B00101010,B00101010,B00111010,B00000000,B00000000}},
  {'6', {B00000000,B00000000,B01001110,B01001010,B01001010,B00111100,B00000000,B00000000}},
  {'7', {B00000000,B00000000,B00110000,B00101000,B00100100,B00100010,B00000000,B00000000}},
  {'8', {B00000000,B00000000,B01111110,B01001010,B01001010,B01111110,B00000000,B00000000}},
  {'9', {B00000000,B00000000,B00111100,B01010010,B01010010,B01010010,B00100000,B00000000}},
};

LedLetter getLedLetter(char character) {
  for (LedLetter letter : LED_LETTERS) {
    if (letter.letter == character) {
      return letter;
    }
  }

  return LedLetter{' ', {}};
}

void displayLedLetter(LedLetter letter, int index) {
  for (int i = 0; i < 8; i++) {
    lc.setRow(index,i,letter.array[i]);
  }
}

void displayString(const char* string, int displayCount) {
  // clear all displays
  for (int i = 0; i < displayCount; i++) {
    lc.clearDisplay(i);
  }

  for (int i = 0; i < strlen(string); i++) {
    LedLetter result = getLedLetter(string[i]);
    if (result.letter != ' ') {
      displayLedLetter(result, i);
    }
  }
}